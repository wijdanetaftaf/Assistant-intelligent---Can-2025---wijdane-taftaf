<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>About ‚Äì CAN 2025</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header class="navbar" id="main-navbar">
    <div class="logo">CAN 2025</div>
    <nav>
        <a href="index.html">Home</a>
        <a href="about.html" class="active">About</a>
        <a href="classement.html">Classement</a>
        <a href="chatbot.html" >Chatbot</a>
        <a href="contact.html">Contact</a>
    </nav>
</header>

<!-- ================= HEADER ================= -->
<section class="page-header">
    <h1>√Ä propos de la CAN 2025</h1>
    <p>Donn√©es officielles ‚Äì joueurs, √©quipes et stades</p>
</section>

<!-- ================= M√âTRIQUES GLOBALES ================= -->
<section class="metrics-row">
    <div class="metric-card">
        <span id="g-joueurs">0</span>
        <p>Joueurs</p>
    </div>
    <div class="metric-card">
        <span id="g-equipes">0</span>
        <p>√âquipes</p>
    </div>
    <div class="metric-card">
        <span id="g-stades">0</span>
        <p>Stades</p>
    </div>
</section>

<!-- ================= JOUEURS ================= -->
<section class="section">
    <h2 class="section-title">üë• Effectifs par √©quipe</h2>

    <select id="teamSelect" class="select"></select>

    <div class="metrics-row">
        <div class="metric-card">
            <span id="j-count">0</span>
            <p>Joueurs</p>
        </div>
        <div class="metric-card">
            <span id="j-postes">0</span>
            <p>Postes</p>
        </div>
        <div class="metric-card">
            <span id="j-age">N/A</span>
            <p>√Çge moyen</p>
        </div>
    </div>

    <table class="data-table">
        <thead>
            <tr>
                <th>Joueur</th>
                <th>Poste</th>
            </tr>
        </thead>
        <tbody id="playersBody"></tbody>
    </table>
</section>

<!-- ================= STADES ================= -->
<section class="section">
    <h2 class="section-title">üèüÔ∏è Stades de la CAN 2025</h2>

    <div class="metrics-row">
        <div class="metric-card">
            <span id="s-count">0</span>
            <p>Stades</p>
        </div>
        <div class="metric-card">
            <span id="s-total">0</span>
            <p>Capacit√© totale</p>
        </div>
        <div class="metric-card">
            <span id="s-avg">0</span>
            <p>Capacit√© moyenne</p>
        </div>
    </div>

    <div class="metrics-row">
        <div class="info-card green" id="biggest"></div>
        <div class="info-card red" id="smallest"></div>
    </div>

    <table class="data-table">
        <thead>
            <tr>
                <th>Stade</th>
                <th>Ville</th>
                <th>Capacit√©</th>
            </tr>
        </thead>
        <tbody id="stadiumsBody"></tbody>
    </table>
</section>

<footer>
    ¬© 2025 CAN ‚Äî Africa Cup of Nations ‚Ä¢ Morocco
</footer>

<script src="js/data.js"></script>
<script>
(async () => {
    const joueurs = await loadCSV("../data/joueurs_brut.csv");
    const stades = await loadCSV("../data/stades.csv");

    /* ===== GLOBAL ===== */
    document.getElementById("g-joueurs").textContent = joueurs.length;
    document.getElementById("g-equipes").textContent =
        new Set(joueurs.map(j => j.equipe)).size;
    document.getElementById("g-stades").textContent = stades.length;

    /* ===== JOUEURS ===== */
    const teams = [...new Set(joueurs.map(j => j.equipe))].sort();
    const select = document.getElementById("teamSelect");

    teams.forEach(t => select.innerHTML += `<option>${t}</option>`);

    function age(text) {
        const m = text?.match(/aged\s*(\d+)/);
        return m ? +m[1] : null;
    }

    function renderPlayers(team) {
        const data = joueurs.filter(j => j.equipe === team);

        document.getElementById("j-count").textContent = data.length;
        document.getElementById("j-postes").textContent =
            new Set(data.map(d => d.poste)).size;

        const ages = data.map(d => age(d.date_naissance)).filter(a => a);
        document.getElementById("j-age").textContent =
            ages.length ? Math.round(ages.reduce((a,b)=>a+b)/ages.length) : "N/A";

        const tbody = document.getElementById("playersBody");
        tbody.innerHTML = "";
        data.forEach(j => {
            tbody.innerHTML += `<tr><td>${j.joueur}</td><td>${j.poste||"-"}</td></tr>`;
        });
    }

    renderPlayers(teams[0]);
    select.onchange = () => renderPlayers(select.value);

    /* ===== STADES (CORRIG√â) ===== */

// Total capacit√©
const total = stades.reduce(
    (sum, s) => sum + cleanNumber(s.capacite),
    0
);

document.getElementById("s-count").textContent = stades.length;
document.getElementById("s-total").textContent = total.toLocaleString("fr-FR");
document.getElementById("s-avg").textContent =
    Math.round(total / stades.length).toLocaleString("fr-FR");

// Plus grand stade
const big = stades.reduce((a, b) =>
    cleanNumber(a.capacite) > cleanNumber(b.capacite) ? a : b
);

// Plus petit stade
const small = stades.reduce((a, b) =>
    cleanNumber(a.capacite) < cleanNumber(b.capacite) ? a : b
);

// Affichage
document.getElementById("biggest").innerHTML = `
    üèÜ <strong>Plus grand stade</strong><br>
    ${big.stade} ‚Äî ${big.ville}<br>
    Capacit√© : ${cleanNumber(big.capacite).toLocaleString("fr-FR")} places
`;

document.getElementById("smallest").innerHTML = `
    üìç <strong>Plus petit stade</strong><br>
    ${small.stade} ‚Äî ${small.ville}<br>
    Capacit√© : ${cleanNumber(small.capacite).toLocaleString("fr-FR")} places
`;

// Tableau
const tbodyS = document.getElementById("stadiumsBody");
tbodyS.innerHTML = "";

stades.forEach(s => {
    tbodyS.innerHTML += `
        <tr>
            <td>${s.stade}</td>
            <td>${s.ville}</td>
            <td>${cleanNumber(s.capacite).toLocaleString("fr-FR")}</td>
        </tr>
    `;
});

})();
</script>

</body>
</html>
